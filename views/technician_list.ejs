<!-- <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../CSS/technician_list.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Ubuntu:ital,wght@0,300;0,400;0,500;0,700;1,300;1,400;1,500;1,700&display=swap" rel="stylesheet">
    <title>Technicians Offering <%= service %> Service</title>
</head>
<body>
    <h1>Technicians Offering <%= service %> Service</h1>
    <ul>
        <% technicianlist.forEach(technician => { %>
            <li>
                <strong>Name:</strong> <%= technician.name %><br>
                <strong>Location:</strong> <%= technician.location %><br>
            </li>
        <% }) %>
    </ul>
</body>
</html> -->
<!-- 
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../CSS/technician_list.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Ubuntu:ital,wght@0,300;0,400;0,500;0,700;1,300;1,400;1,500;1,700&display=swap"
        rel="stylesheet">
    <title>Technicians List</title>
</head>

<body>
    <header>
        <h1>Technicians Offering <%= service %> Service</h1>
    </header>
    <div class="container">
        <ul class="technician-list">
            <% technicianlist.forEach(technician => { %>
            <li class="technician-item">
                <div class="technician-info">
                    <h2>Name: <%= technician.firstName %> <%= technician.lastName %></h2>
                 <h2>Address: <%= technician.location %></h2>
                    <h2>Contact: <%= technician.name %></h2>
                    <p class="location">A<%= technician.location %></p>
                </div>
            </li>
            <% }) %>
        </ul>
    </div>
</body>

</html>

-->

<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../CSS/technician_list.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Ubuntu:ital,wght@0,300;0,400;0,500;0,700;1,300;1,400;1,500;1,700&display=swap"
        rel="stylesheet">
    <title>Technicians List</title>
</head>

<body>
    <header>
        <h1>Technicians Offering <%= service %> Service</h1>
    </header>
    <!-- <button id="filterButton">Filter Technicians</button>
    <script>
        // Add event listener to the filter button
        document.getElementById('filterButton').addEventListener('click', function () {
            // Redirect to the /filter route
            window.location.href = '/filter?service=<%= service %>';
        });
    </script> -->
    <a href="/filter">Filter Technician</a>




    <div class="container">
        <ul class="technician-list">
            <% technicianlist.forEach(technician => { %>
            <li class="technician-item">
                <div class="technician-info">
                    <h2>Name: <%= technician.firstName %> <%= technician.lastName %></h2>
                    <h2>Contact: <%= technician.name %></h2>
                    <!-- <p class="location" data-latitude="<%= technician.latitude %>" data-longitude="<%= technician.longitude %>">Adress: <%= technician.location %></p> -->
                    <!-- <p class="location" data-coordinates='<%= JSON.stringify(technician.location) %>'>Adress: <%= technician.location %></p> -->
                </div>
            </li>
            <% }) %>
        </ul>
    </div>



    <!--  
    <script>
        document.getElementById('filterButton').addEventListener('click', function () {
            // Perform filtering logic here
            // You can use JavaScript to make an AJAX request to the server to fetch filtered technicians based on location
            // and then update the list accordingly.
            // Alternatively, you can use JavaScript to filter technicians already present in the page without making a server request.
            // Example: filtering technicians based on location already present in the page
            // Note: This assumes you have latitude and longitude information for technicians in the page.
            const maxDistanceInMeters = 1000; // Example: maximum distance in meters
            const clientLocation = [longitude, latitude]; // Example: client's location [longitude, latitude]
            const technicianItems = document.querySelectorAll('.technician-item');

            technicianItems.forEach(function (item) {
                const technicianLatitude = parseFloat(item.dataset
                .latitude); // Example: latitude stored as data attribute
                const technicianLongitude = parseFloat(item.dataset
                .longitude); // Example: longitude stored as data attribute
                const distance = calculateDistance(clientLocation[1], clientLocation[0],
                    technicianLatitude, technicianLongitude
                    ); // Calculate distance between client and technician
                if (distance > maxDistanceInMeters) {
                    item.style.display = 'none'; // Hide technician if distance exceeds maximum distance
                } else {
                    item.style.display =
                    'block'; // Show technician if distance is within maximum distance
                }
            });
        });

        // Function to calculate distance between two points using Haversine formula
        function calculateDistance(lat1, lon1, lat2, lon2) {
            const R = 6371; // Radius of the earth in km
            const dLat = deg2rad(lat2 - lat1); // deg2rad below
            const dLon = deg2rad(lon2 - lon1);
            const a =
                Math.sin(dLat / 2) * Math.sin(dLat / 2) +
                Math.cos(deg2rad(lat1)) * Math.cos(deg2rad(lat2)) *
                Math.sin(dLon / 2) * Math.sin(dLon / 2);
            const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));
            const d = R * c; // Distance in km
            return d * 1000; // Convert to meters
        }

        function deg2rad(deg) {
            return deg * (Math.PI / 180);
        }
    </script>
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            // Add event listener for the filter button
            document.getElementById('filterButton').addEventListener('click', function () {
                // Send a request to the server to filter technicians based on location
                // You can use fetch API or any JavaScript library (e.g., Axios) to make the request
                fetch('/filterTechnicians')
                    .then(response => response.json())
                    .then(data => {
                        // Replace the technician list with the filtered list
                        const technicianList = document.querySelector('.technician-list');
                        technicianList.innerHTML = '';
                        data.forEach(technician => {
                            const li = document.createElement('li');
                            li.classList.add('technician-item');
                            li.innerHTML = `
                                    <div class="technician-info">
                                        <h2>Name: ${technician.firstName} ${technician.lastName}</h2>
                                        <h2>Contact: ${technician.name}</h2>
                                    </div>
                                `;
                            technicianList.appendChild(li);
                        });
                    })
                    .catch(error => {
                        console.error('Error filtering technicians:', error);
                    });
            });
        });
    </script>

-->




</body>

</html>